"""Adding events to user calendar."""


from datetime import datetime
import urllib.parse


def add_to_google_calendar(stock_symbol: str, date: datetime) -> None:
    """Add next earnings call to Google Calendar.

    Args:
        stock_symbol: Stock with earnings call.
        date: Datetime of earnings call as one day; event will be all day.
    """

    date = date.strftime("%Y%m%d")
    link: str = "https://www.google.com/calendar/render?"
    params = {
        "action": "TEMPLATE",
        "text": f"{stock_symbol} estimated earnings call",  # Title of event
        "dates": f"{date}/{date}",  # Use `20230912T221500Z` or `20230912T2215` for local timezone
        "details": "Event generated by auraviz.app:+https://auraviz.app",
        # "location": "502 E Boone Ave, Spokane, WA 98258",
        # "ctz": "",  # Timezone
        # "add": "",  # List of emails
    }

    return link + urllib.parse.urlencode(params)


def add_to_outlook_calendar() -> str:
    """Add next earnings call to Outlook Calendar."""
    # TODO:
    # https://github.com/InteractionDesignFoundation/add-event-to-calendar-docs/blob/main/services/outlook-web.md
    return ""


print(add_to_google_calendar("GOOGL", datetime.now()))
